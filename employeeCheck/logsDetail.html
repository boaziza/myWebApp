<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pompiste Report</title>
  <link rel="stylesheet" href="logsDetail.css">
  
</head>
<body>
  <div class="fuel-prices">
    <h2>Live Fuel Prices</h2>
    <p>ESSENCE: <span id="pmsPrice"></span></p>
    <p>MAZOUT: <span id="agoPrice"></span></p>
  </div>

  <header>
    <div style="justify-content: center; display: flex;">
      <h1>Pompiste Report</h1>
    </div>

    <div>
      <div><strong>Email:&nbsp;&nbsp;<input type="email" name="email" id="email"></strong></div>
      <div><strong>Date:&nbsp;&nbsp;<input type="date" name="logDate" id="logDate"></strong></div>
    </div>
  </header>

  <nav>
    <ul>
      <li><a href="../index">Rapport&nbsp;&nbsp;&nbsp;</a></li>
      <li><a href="../home/stock">Stock&nbsp;&nbsp;&nbsp;</a></li>
      <li><a href="../home/situation">Situation&nbsp;&nbsp;&nbsp;</a></li>
        <li class="dropdown">
            <a href="#"> Reports </a>
            <ul class="dropdown-menu">                
                <li><a href="logsDetail">Pompiste's Report</a></li>
                <li><a href="../gain/gain">Gain/Loss Report</a></li>
            </ul>
        </li>
    </ul>
  </nav><br>

  <main class="sheet">

    <section class="indices">
      <table class="indices-table">
        <thead>
          <tr>
            <th>P</th>
            <th>POMPE N°</th>
            <th>Fin journée</th>
            <th>Début journée</th>
            <th>Essence (L)</th>
            <th>Gasoil (L)</th>
            <th>Kérosène (L)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>P1</td>
            <td>Pump 1</td>
            <td><span id="pms2"></span></td>
            <td><span id="pms1"></span></td>
            <td><span id="p1_essence"></span></td>
            <td><span id="p1_gasoil">-</span></td>
            <td><span id="p1_kero">-</span></td>
          </tr>

          <tr>
            <td>P2</td>
            <td>Pump 2</td>
            <td><span id="pms4"></span></td>
            <td><span id="pms3"></span></td>
            <td><span id="p2_essence"></span></td>
            <td><span id="p2_gasoil">-</span></td>
            <td><span id="p2_kero">-</span></td>
          </tr>

          <tr>
            <td>P3</td>
            <td>Pump 3</td>
            <td><span id="ago2"></span></td>
            <td><span id="ago1"></span></td>
            <td><span id="p3_essence">-</span></td>
            <td><span id="p3_gasoil"></span></td>
            <td><span id="p3_kero">-</span></td>
          </tr>

          <tr>
            <td>P4</td>
            <td>Pump 4</td>
            <td><span id="ago4"></span></td>
            <td><span id="ago3"></span></td>
            <td><span id="p4_essence">-</span></td>
            <td><span id="p4_gasoil"></span></td>
            <td><span id="p4_kero">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Total litres (A)</td>
            <td><span id="venteLitresPms"></span></td>
            <td><span id="venteLitresAgo"></span></td>
            <td><span id="venteLitresKerosene">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Fuel Transfered(B)</td>
            <td><span id="transferedPms"></span></td>
            <td><span id="transferedAgo"></span></td>
            <td><span id="transferedKerosene">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Total litres Sold (C=A-B)</td>
            <td><span id="venteLitresPms"></span></td>
            <td><span id="venteLitresAgo"></span></td>
            <td><span id="venteLitresKerosene">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Price (D)</td>
            <td><span id="pmsPrice"></span></td>
            <td><span id="agoPrice"></span></td>
            <td><span id="kerosenePrice">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Total Sales in Frws (CxD)</td>
            <td><span id="totalPms"></span></td>
            <td><span id="totalAgo"></span></td>
            <td><span id="totalKerosene">-</span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>Total Sales(FRW)</td>
            <td><span id="totalVente"></span></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="totals-and-payments avoid-break">     

      <div class="payments">
        <h3>Payments</h3>
        <div class="pay-row"><label>MoMo:</label><span id="momo"></span></div>
        <div class="pay-row"><label>Terminal:</label><span id="terminal"></span></div>
        <div class="pay-row"><label>SP Fuel Card:</label><span id="spFuelCard"></span></div>
        <div class="pay-row"><label>Bank Card:</label><span id="bankCard"></span></div>
        <div class="pay-row"><label>Fiche: </label><span id="fiche"></span></div>
        <div class="pay-row"><label>MoMo Loss:</label><span id="momoLoss"></span></div>
        <div class="pay-row"><label>Total Cash:</label><span id="totalCash"></span></div>
        <div class="pay-row"><label>Total Sales:</label><span id="totalPayments"></span></div>
        <div class="pay-row"><label>Gain/Loss :</label><span id="gainPayments"></span></div>
      </div>
    </section>

  </main>
  <script type="module" src="logs.js"></script>
  <button onclick="displayDetails()">Fetch Report</button>
  <button id="downloadReport">Download Report</button><br><br>
  <button onclick="logout()"> Log Out</button>
  <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.0"></script>
  <script type="module" src="../home/fuelPrices.js"></script>
  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    document.getElementById("downloadReport").addEventListener("click", function () {
      // Ensure data is up to date
      // If your displayDetails() fetches/fills data, call it here or make sure it's already run
      // displayDetails();

      // Choose the section to export: body, main, or a wrapper

      const logDate = document.getElementById("logDate").value;
      const email = document.getElementById("email").value;

      const element = document.body;

      const opt = {
        margin:       0.4,
        filename:     email + logDate + ".pdf",
        image:        { type: "jpeg", quality: 0.98 },
        html2canvas:  { scale: 4, useCORS: true, scrollY: 0 },        
        jsPDF:        { unit: "px", format: [element.scrollWidth, element.scrollHeight], orientation: "portrait" },
        pagebreak:    { mode: ['css', 'legacy'] } 
      };

      html2pdf().set(opt).from(element).save();
    });
  </script>
  <script src="../home/pageAccess.js"></script>
  <script src="../home/logout.js"></script>
  <script src="../home/checkUser.js"></script>
  <script src="../utils/welcomeMessage.js"></script>

</body>
</html>
